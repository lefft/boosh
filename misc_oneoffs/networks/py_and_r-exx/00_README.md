A translation of the code in [this blog post](http://groupefmr.hypotheses.org/4161).

![](http://i.imgur.com/4WiDmcC.png)